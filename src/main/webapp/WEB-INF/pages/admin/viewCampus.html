<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>教务中心-老师学校选择</title>
    <link rel="stylesheet" href="../../static/css/personalCenter/educationalCenter/teacherSystem-schoolB.css">
    <script type="text/javascript" src="../../../static/caohao/js/jquery-easyui-1.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="../../../static/caohao/js/jquery-easyui-1.4.1/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../../../static/caohao/js/jquery-easyui-1.4.1/locale/easyui-lang-zh_CN.js"></script>
    <script type="text/javascript" src="../../../static/caohao/js/common.js"></script>
</head>
<body>
<!--头部信息开始-->
<div class="ps-header">
    <div class="ps-conBox">
        <a href="" class="ps-c1">HOME</a>
        <a href="" class="ps-c2">Teachers' Office Center</a>
        <div class="ps-c3">
            <a href="" class="ps-3-words">SIGN OUT</a>
        </div>
    </div>
</div>
<!--中间主体信息部分开始-->
<div class="mr-title">
    <span>Select the campus</span>
</div>
<div class="mr-ChooseBox">
    <div class="mrcb-campusBox">
        <img src="../../images/personal/bj.png" alt="" />
        <div class="mrcb-inside">
            <span class="mrcb-campus" id="1" name="" onclick="testAddSubPageForAjax('学生成绩','http://43.241.229.59:8080/user/home#/studentSystem',name)"></span>
        </div>
    </div>
    <div class="mrcb-campusBox">
        <img src="../../images/personal/bj.png" alt="" />
        <div class="mrcb-inside">
            <span class="mrcb-campus" id="2" name="" onclick="testAddSubPageForAjax('学生成绩','http://43.241.229.59:8080/user/home#/studentSystem',name)"></span>
        </div>
    </div>
    <div class="mrcb-campusBox">
        <img src="../../images/personal/bj.png" alt="" />
        <div class="mrcb-inside">
            <span class="mrcb-campus" id="3" name="" onclick="testAddSubPageForAjax('学生成绩','http://43.241.229.59:8080/user/home#/studentSystem',name)"></span>
        </div>
    </div>
    <div class="mrcb-campusBox">
        <img src="../../images/personal/bj.png" alt="" />
        <div class="mrcb-inside">
            <span class="mrcb-campus" id="4" name="" onclick="testAddSubPageForAjax('学生成绩','http://43.241.229.59:8080/user/home#/studentSystem',name)"></span>
        </div>
    </div>
    <div class="mrcb-campusBox">
        <img src="../../images/personal/bj.png" alt="" />
        <div class="mrcb-inside">
            <span class="mrcb-campus" id="5" name="" onclick="testAddSubPageForAjax('学生成绩','http://43.241.229.59:8080/user/home#/studentSystem',name)"></span>
        </div>
    </div>
    <div class="mrcb-campusBox">
        <img src="../../images/personal/bj.png" alt="" />
        <div class="mrcb-inside">
            <span class="mrcb-campus" id="6" name="" onclick="testAddSubPageForAjax('学生成绩','http://43.241.229.59:8080/user/home#/studentSystem',name)"></span>
        </div>
    </div>
    <div class="mrcb-campusBox">
        <img src="../../images/personal/bj.png" alt="" />
        <div class="mrcb-inside">
            <span class="mrcb-campus" id="7" name="" onclick="testAddSubPageForAjax('学生成绩','http://43.241.229.59:8080/user/home#/studentSystem',name)"></span>
        </div>
    </div>
    <div class="mrcb-campusBox">
        <img src="../../images/personal/bj.png" alt="" />
        <div class="mrcb-inside">
            <span class="mrcb-campus" id="8" name="" onclick="testAddSubPageForAjax('学生成绩','http://43.241.229.59:8080/user/home#/studentSystem',name)"></span>
        </div>
    </div>


</div>
</div>
<script>
    var id;
    //    边框变色
    //    $(".mrcb-campusBox").mouseover(
    //            function () {
    //                $(".mrcb-inside").css("border","2px solid #00b7ee")
    //            }
    //    );
    //    $(".mrcb-campusBox").mouseout(
    //            function () {
    //                $(".mrcb-inside").css("border","2px solid #e5e5e5")
    //            }
    //    )
    $(function() {
        startInit('mainiFrame', 1000);
        var reg = new RegExp("(^|&)"+ "id" +"=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        id=unescape(r[2]);
        //alert(id);

        var formData=new FormData();
        //formData.append("id",id);
        formData.append("page",1);
        formData.append("rows",8);

        $.ajax({
            url:'/campus/show/page',
            type:"POST",
            data:formData,
            dataType: "text",
            processData:false,
            contentType:false,
            //headers: {"Content-Type": "application/json;charset=utf-8"},
            success:function(data){
                var obj= jQuery.parseJSON(data);
                var objSZ=JSON.stringify(obj.data);
                document.getElementById('1').innerText=obj.data.list[0].campusName;
                document.getElementById('1').name=obj.data.list[0].id;

                document.getElementById('2').innerText=obj.data.list[1].campusName;
                document.getElementById('2').name=obj.data.list[1].id;

                document.getElementById('3').innerText=obj.data.list[2].campusName;
                document.getElementById('3').name=obj.data.list[2].id;

                document.getElementById('4').innerText=obj.data.list[3].campusName;
                document.getElementById('4').name=obj.data.list[3].id;

                document.getElementById('5').innerText=obj.data.list[4].campusName;
                document.getElementById('5').name=obj.data.list[4].id;

                document.getElementById('6').innerText=obj.data.list[5].campusName;
                document.getElementById('6').name=obj.data.list[5].id;

                document.getElementById('7').innerText=obj.data.list[6].campusName;
                document.getElementById('7').name=obj.data.list[6].id;

                document.getElementById('8').innerText=obj.data.list[7].campusName;
                document.getElementById('8').name=obj.data.list[7].id;

            },
            error:function (data) {
                alert('获取校区信息失败，请重试');
            }
        })

    });


    function testAddSubPage(title,url,name){
        /*alert(id);  //userId
        alert(name);  //campusId*/
        //http://localhost:8080/user/home#/studentSystem?courseArrangeId=80&campusId=1&studentId=3
        var jq = top.jQuery;

        /*****************************************/


        var formData_T=new FormData();
        //formData.append("id",id);
        formData_T.append("page",1);
        formData_T.append("rows",8);
        formData_T.append("campusId",name);
        formData_T.append("studentId",id);

        var cid=null;
        alert('begin');
        $.ajax({
            url:'/homeWork/student/myCourse',
            type:"POST",
            data:formData_T,
            dataType: "text",
            processData:false,
            contentType:false,
            //headers: {"Content-Type": "application/json;charset=utf-8"},
            success:function(data){
                alert('success');
                var obj= jQuery.parseJSON(data);
                //var objSZ=JSON.stringify(obj.data);
                alert(obj.rows.length);
            },
            error:function (data) {
                alert('获取course arrange id 失败，请重试');
            }
        })
        alert('end');

        /**********************************************/
        url=url+"?courseArrangeId=79"+"&campusId="+1+"&studentId="+1;
        if (jq("#tabs").tabs('exists', title)){
            jq("#tabs").tabs('select', title);
        } else {
            var content = '<iframe id="mainiframe" scrolling="auto" frameborder="0"  src="'+url+'" style="padding: 10px; width: 100%; height: 1000px;"></iframe>';
            jq("#tabs").tabs('add',{
                title:title,
                content:content,
                closable:true
            });
        }
    }



    function testAddSubPageForAjax(title,url,name){
        /*alert(id);  //userId
        alert(name);  //campusId*/
        //http://localhost:8080/user/home#/studentSystem?courseArrangeId=80&campusId=1&studentId=3
        //var jq = top.jQuery;
        /*****************************************/
        var formData_T=new FormData();
        //formData.append("id",id);
        formData_T.append("page",1);
        formData_T.append("rows",8);
        formData_T.append("campusId",name);
        formData_T.append("studentId",id);
        $.ajax({
            url:'/homeWork/student/myCourse',
            type:"POST",
            data:formData_T,
            dataType: "text",
            processData:false,
            contentType:false,
            //headers: {"Content-Type": "application/json;charset=utf-8"},
            success:function(data){
                if(data.length==0){
                    alert('该生没有在该校区选过课。');
                }else{
                    var obj= jQuery.parseJSON(data);
                    //alert(obj.rows[0].id);
                    url=url+"?courseArrangeId="+obj.rows[0].id+"&campusId="+name+"&studentId="+id;
                    turnNewPage(title,url);
                }
                /*alert(data.toString());
                var obj= jQuery.parseJSON(data);
                //var objSZ=JSON.stringify(obj.data);
                if(obj==null||obj.length()==0){
                    alert("null");
                }else{
                    alert(obj.length+obj.length());
                    alert(obj.rows.length);
                }*/
            },
            error:function (data) {
                alert('获取course arrange id 失败，请重试');
            }
        })

        /**********************************************/
        /*url=url+"?courseArrangeId=79"+"&campusId="+1+"&studentId="+1;
        if (jq("#tabs").tabs('exists', title)){
            jq("#tabs").tabs('select', title);
        } else {
            var content = '<iframe id="mainiframe" scrolling="auto" frameborder="0"  src="'+url+'" style="padding: 10px; width: 100%; height: 1000px;"></iframe>';
            jq("#tabs").tabs('add',{
                title:title,
                content:content,
                closable:true
            });
        }*/
    }


    function turnNewPage(title,url) {
        var jq = top.jQuery;
        if (jq("#tabs").tabs('exists', title)){
            jq("#tabs").tabs('select', title);
        } else {
            var content = '<iframe id="mainiframe" scrolling="auto" frameborder="0"  src="'+url+'" style="padding: 10px; width: 100%; height: 1000px;"></iframe>';
            jq("#tabs").tabs('add',{
                title:title,
                content:content,
                closable:true
            });
        }
    }



    var browserVersion = window.navigator.userAgent.toUpperCase();
    var isOpera = browserVersion.indexOf("OPERA") > -1 ? true : false;
    var isFireFox = browserVersion.indexOf("FIREFOX") > -1 ? true : false;
    var isChrome = browserVersion.indexOf("CHROME") > -1 ? true : false;
    var isSafari = browserVersion.indexOf("SAFARI") > -1 ? true : false;
    var isIE = (!!window.ActiveXObject || "ActiveXObject" in window);
    var isIE9More = (! -[1, ] == false);
    function reinitIframe(iframeId, minHeight) {
        try {
            var iframe = document.getElementById(iframeId);
            var bHeight = 0;
            if (isChrome == false && isSafari == false)
                bHeight = iframe.contentWindow.document.body.scrollHeight;

            var dHeight = 0;
            if (isFireFox == true)
                dHeight = iframe.contentWindow.document.documentElement.offsetHeight + 2;
            else if (isIE == false && isOpera == false)
                dHeight = iframe.contentWindow.document.documentElement.scrollHeight;
            else if (isIE == true && isIE9More) {//ie9+
                var heightDeviation = bHeight - eval("window.IE9MoreRealHeight" + iframeId);
                if (heightDeviation == 0) {
                    bHeight += 3;
                } else if (heightDeviation != 3) {
                    eval("window.IE9MoreRealHeight" + iframeId + "=" + bHeight);
                    bHeight += 3;
                }
            }
            else//ie[6-8]、OPERA
                bHeight += 3;

            var height = Math.max(bHeight, dHeight);
            if (height < minHeight) height = minHeight;
            iframe.style.height = height + "px";
        } catch (ex) { }
    }
    function startInit(iframeId, minHeight) {
        eval("window.IE9MoreRealHeight" + iframeId + "=0");
        window.setInterval("reinitIframe('" + iframeId + "'," + minHeight + ")", 100);
    }

</script>
</body>
</html>
